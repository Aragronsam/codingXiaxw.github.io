<!DOCTYPE html>
<html>

<!-- Head tag -->

<head>
 	 <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Life is short,just coding.">
    <meta name="keyword"  content="undefined">
    <title>JavaWeb学习笔记之Jdbc(一) | Stephen&#39;s blog</title>
    <!-- Favicon -->
    <link rel="Shortcut Icon" href="/favicon.ico">

    <!-- css files -->
    <link rel="stylesheet" href="/css/app.css">
    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/font-awesome.min.css">

</head>

<body>
	<!-- header -->
	<header class="header">
    <section class="banner">
        <div class="banner-image">
            <img src="http://7xl0rs.com1.z0.glb.clouddn.com/banner.png" alt="banner">
        </div>
        <img class="avatar" src="http://7xl0rs.com1.z0.glb.clouddn.com/avatar.png" alt="avatar" >
    </section>

    <nav class="nav">
    
    	<a href="/">Home</a>
    
    	<a href="/archives">Archives</a>
    
    	<a href="/about">About</a>
    
    	<a href="/atom.xml">Rss</a>
    
    </nav>
    <button class="menu-toggle">
        <div class="nav-bar">
             
                <a href="/">Home</a>
            
                <a href="/archives">Archives</a>
            
                <a href="/about">About</a>
            
                <a href="/atom.xml">Rss</a>
            
        </div>
    </button>
    
</header>

	<!-- Main content -->
	<main class="post">

	<article>
	<h1 class="article-title">
	   JavaWeb学习笔记之Jdbc(一)
	</h1>

	<section class="post-time">
		<span class="post-date">10-12</span>
	</section>

	<section class="article-entry">
	    <h2 id="1-概念"><a href="#1-概念" class="headerlink" title="1.概念"></a>1.概念</h2><p>Jdbc(java database connectivity):Java数据库连接，就是用Java语言来操作数据库。原来我们操作数据库是在控制台中通过sql语句来操作数据库，而Jdbc是用Java语言来向数据库发送sql语句来操作数据库。</p>
<a id="more"></a>
<h2 id="2-流程"><a href="#2-流程" class="headerlink" title="2.流程"></a>2.流程</h2><h3 id="2-1得到Connection对象"><a href="#2-1得到Connection对象" class="headerlink" title="2.1得到Connection对象"></a>2.1得到Connection对象</h3><ul>
<li>1.导jar包。mysql-connector-java jar</li>
<li>2.加载驱动类:Class.forName(“类名”);</li>
<li>3.给出url、username、password等参数。</li>
<li>4.使用DriverManager类来的到Connection对象。</li>
</ul>
<p><strong>时刻牢记Jdbc中的四大参数:</strong></p>
<ul>
<li>driverClassName:com.mysql.jdbc.Driver</li>
<li>url:jdbc:mysql://localhost:3306/数据库名</li>
<li>username:mysql用户名</li>
<li>password:mysql密码</li>
</ul>
<p><strong>Demo:</strong></p>
<pre><code>public class Demo{
    public void main(String[] args) throws ClassNotFoundException,SQLException{

        Class.forName(&quot;com.mysql.jdbc.Driver&quot;);//加载驱动类。
        String url=&quot;jdbc:mysql://localhost:3306/数据库名&quot;;
        String username=&quot;root&quot;;
        String password=&quot;123&quot;;

        Connection con=DriverManager.getConnection(url,username,password);
    }
}
</code></pre><p><strong>代码分析:</strong>  </p>
<ol>
<li>url的格式为–jdbc:厂商名称:子协议(由厂商自己来规定)。对于mysql而言，它的子协议结构的格式为://localhost:3306/数据库名。</li>
<li>出现SQLException的原因:1.url username password 是否正确。2.检查是否打开了sql服务器</li>
<li>出现ClassNotFoundException的原因:1.没导入驱动包。2.Class.forName()传入的字符串参数错误。</li>
</ol>
<h2 id="3-Jdbc对数据库进行增、删、改、查"><a href="#3-Jdbc对数据库进行增、删、改、查" class="headerlink" title="3.Jdbc对数据库进行增、删、改、查"></a>3.Jdbc对数据库进行增、删、改、查</h2><h3 id="3-1增、删、改"><a href="#3-1增、删、改" class="headerlink" title="3.1增、删、改"></a>3.1增、删、改</h3><pre><code>public class Demo{
    public void main(String[] args) throws ClassNotFoundException,SQLException{

        Class.forName(&quot;com.mysql.jdbc.Driver&quot;);//加载驱动类。
        String url=&quot;jdbc:mysql://localhost:3306/数据库名&quot;;
        String username=&quot;root&quot;;
        String password=&quot;123&quot;;

        Connection con=DriverManager.getConnection(url,username,password);

        Statement stmt=con.createStatement();//调用Connection的方法创建Statement对象，它是sql语句的发送器，功能就是向数据库发送sql语句
        String sql＝&quot;insert into stu values(&apos;...&apos;,&apos;...&apos;,&apos;...&apos;,&apos;...&apos;)&quot;;//右括号不需要打分号，打了就会出错，因为程序会自动帮我们加。
        stmt.executeUpdate(sql);//调用此方法向数据库发送sql语句。该语句返回的值为改变数据库的行数。
    }
}
</code></pre><p><strong>注意:</strong>上述中出现的Connection和Statement都应该导入java.mysql下的包，而不是java.jdbc下的包。</p>
<h3 id="3-2查询"><a href="#3-2查询" class="headerlink" title="3.2查询"></a>3.2查询</h3><p><strong>Demo:</strong></p>
<pre><code>public class Demo{
    public void main(String[] args) throws ClassNotFoundException,SQLException{

        Class.forName(&quot;com.mysql.jdbc.Driver&quot;);//加载驱动类。
        String url=&quot;jdbc:mysql://localhost:3306/数据库名&quot;;
        String username=&quot;root&quot;;
        String password=&quot;123&quot;;

        Connection con=DriverManager.getConnection(url,username,password);

        Statement stmt=con.createStatement();

        String sql=&quot;selece * from stu&quot;;

        ResultSet rs=stmt.execute(sql);

        /*
         *解析ResultSet
         *ResultSet提供了一系列的getXxx()方法
         */
         while(rs.next())//第一次调用next()方法是将光标移动到该表的第一行
         {
             rs.getInt(1);//通过列编号来获取该列的值
             rs.getString(&quot;name&quot;);//通过列名称来获取该列的值。
         }
    }
}
</code></pre><h2 id="4-关闭资源"><a href="#4-关闭资源" class="headerlink" title="4.关闭资源"></a>4.关闭资源</h2><p>关闭资源时采用倒关的手法将对象进行处理:即先得到的对象后关，后得到的对象先关。  </p>
<pre><code>rs.close();
stmt.close();
con.close();
</code></pre><p>为了注意代码的规范化:在try外给出引用的定义，在try内位对象实例化，在finally中对资源进行关闭。</p>
<h2 id="5-PreparedStatement-预处理"><a href="#5-PreparedStatement-预处理" class="headerlink" title="5.PreparedStatement(预处理)"></a>5.PreparedStatement(预处理)</h2><h3 id="5-1介绍"><a href="#5-1介绍" class="headerlink" title="5.1介绍"></a>5.1介绍</h3><p>PrepaerdStatement是Statement的子接口。下面通过一个例子学习PreparedStatement，注意与上述例子中Statement的区别。             </p>
<pre><code>public class Demo{
    public void main(String[] args) throws ClassNotFoundException,SQLException{

        Class.forName(&quot;com.mysql.jdbc.Driver&quot;);//加载驱动类。
        String url=&quot;jdbc:mysql://localhost:3306/数据库名&quot;;            String username=&quot;root&quot;;
        String password=&quot;123&quot;;

        Connection con=DriverManager.getConnection(url,username,password);

        String sql=&quot;insert into stu where username=? and password=?&quot;;//定义sql模板，即参数以问号的形式给出

        PreparedStatement pst=con.prepaerStatement(sql);
        pst.setString(1,username);//数字1代表第一个问号
        pst.setString(2.password);//数字2代表第二个问号
        pst.executeUpdate();//向数据库发送sql语句
    }
}
</code></pre><h3 id="5-2预处理的原理"><a href="#5-2预处理的原理" class="headerlink" title="5.2预处理的原理"></a>5.2预处理的原理</h3><p>服务器的工作:</p>
<ul>
<li>1.检验sql语句的语法</li>
<li>2.编译：一个与函数相似的东西</li>
<li>3.执行：调用函数</li>
</ul>
<p>PreparedStatement使用的前提就是:连接的数据库必须支持预处理。</p>
<p>以后我们要学的DAO模式就是写一个类，把访问数据库的代码封装起来，DAO在数据库与业务逻辑层之间。</p>
<h2 id="6-Java中的时间类型和mysql中的时间类型转换"><a href="#6-Java中的时间类型和mysql中的时间类型转换" class="headerlink" title="6.Java中的时间类型和mysql中的时间类型转换"></a>6.Java中的时间类型和mysql中的时间类型转换</h2><h3 id="6-1数据库类型与Java中类型的对应关系"><a href="#6-1数据库类型与Java中类型的对应关系" class="headerlink" title="6.1数据库类型与Java中类型的对应关系"></a>6.1数据库类型与Java中类型的对应关系</h3><p>数据库中的DATE–&gt;java.sql.Date–&gt;java.util.Date;  </p>
<p>数据库中的TIME–&gt;java.sql.Time–&gt;java.util.Date;  </p>
<p>数据库中的TIMESTAMP–&gt;java.sql.Timestamp–&gt;java.util.Date;  </p>
<p><strong>需要注意的是:</strong></p>
<ul>
<li>1.领域对象(domain)中的所有属性不能出现java.sql包下的东西，即不能使用java.sql.Date、java.sql.Time、java.sql.TimeStamp。</li>
<li>2.ResultSet的getDate()返回的是java.sql.Date()。</li>
<li>3.PreparedStatment的setDate(int,Date),其中第二个参数是sql包下的java.sql.Date()。为了在java中使用sql包下的时间类型，这是就出现了时间类型的转换。</li>
</ul>
<h3 id="6-2转换"><a href="#6-2转换" class="headerlink" title="6.2转换"></a>6.2转换</h3><h4 id="6-2-1将util包下的Date转换为sql包下的Date、Time、Timestamp"><a href="#6-2-1将util包下的Date转换为sql包下的Date、Time、Timestamp" class="headerlink" title="6.2.1将util包下的Date转换为sql包下的Date、Time、Timestamp"></a>6.2.1将util包下的Date转换为sql包下的Date、Time、Timestamp</h4><p><strong>步骤如下:</strong></p>
<ul>
<li>1.把util的的Date转换成毫秒值。</li>
<li>2.使用毫秒值创建sql的Date、Time、Timestamp  <blockquote>
<p>java.util.Date date=new java.util.Date();<br>long l=date.getTime();<br>java.sql.Date sqlDate=new java.sql.Date(l);</p>
</blockquote>
</li>
</ul>
<h4 id="6-2-2将sql包下的Date、Time、Timestamp转换为util包下的Date"><a href="#6-2-2将sql包下的Date、Time、Timestamp转换为util包下的Date" class="headerlink" title="6.2.2将sql包下的Date、Time、Timestamp转换为util包下的Date"></a>6.2.2将sql包下的Date、Time、Timestamp转换为util包下的Date</h4><p>这一步不需要处理了，因为sql包下的Date、Time、和Timestamp继承自util包下的Date。所以可以直接用:  </p>
<pre><code>new java.util.Date()=new java.sql.Date();或
new java.util.Date()=new java.sql.Time();或
new java.util.Date()=new java.sql.Timestamp();  
</code></pre><h2 id="7-大数据"><a href="#7-大数据" class="headerlink" title="7.大数据"></a>7.大数据</h2><p>将大数据的歌曲存入数据库。代码日后补上。</p>
<h2 id="8-批处理"><a href="#8-批处理" class="headerlink" title="8.批处理"></a>8.批处理</h2><h3 id="8-1Statement批处理"><a href="#8-1Statement批处理" class="headerlink" title="8.1Statement批处理"></a>8.1Statement批处理</h3><p>批处理就是一批一批的处理，而不是一个一个的处理。  </p>
<p>当你有10条sql语句要执行时，一次向服务器发送一条语句，这么做效率很差。处理的方案是用批处理，即一次向服务器发送多条sql语句，然后由服务器一次性处理。  </p>
<p>批处理只针对更新(增、删、改),没有查询什么事。  </p>
<p>添加批的语句:PreparedStatement.addBatch();<br>执行批的语句:PreparedStatement.executeBatch();  </p>
<p>mysql默认批处理是关闭的，需要在url参数后面加上?rewriteBatchedStatement=true;</p>
<h2 id="9-联系"><a href="#9-联系" class="headerlink" title="9.联系"></a>9.联系</h2><p>  If you have some questions after you see this article,you can tell your doubts in the comments area or you can find some info by  clicking these links.</p>
<ul>
<li><p><a href="codingxiaxw.cn">blog@codingXiaxw’s blog</a></p>
</li>
<li><p><a href="http://weibo.com/u/5023661572?from=hissimilar_home&amp;refer_flag=1005050003_" target="_blank" rel="external">Weibo@codingXiaxw</a></p>
</li>
<li><p><a href="http://www.zhihu.com/people/e9f78fa34b8002652811ac348da3f671" target="_blank" rel="external">Zhihu@codingXiaxw</a>  </p>
</li>
<li><a href="https://github.com/codingXiaxw" target="_blank" rel="external">github@codingXiaxw</a></li>
</ul>

	</section>	
</article>

</main>

	<!-- footer -->
	<footer>
	<div class="social">
		<a href="https://twitter.com">
			<i class="fa fa-twitter fa-2x" aria-hidden="true"></i>
		</a>
		<a href="https://github.com/stephenLYao">
			<i class="fa fa-github fa-2x" aria-hidden="true"></i>
		</a>
		<a href="http://www.weibo.com/3103316530/profile?rightmod=1&wvr=6&mod=personinfo">
			<i class="fa fa-weibo fa-2x" aria-hidden="true"></i>
		</a>
	</div>
	<p>@2016.Power by <a rel="nofollow"  href="https://hexo.io">Hexo</a>. Theme <a rel="nofollow" href="https://github.com/stephenLYao/hexo-theme-fresh.git">fresh</p>
</footer>


	
	<!-- js -->
	<script type="text/javascript" src="https://cdn.bootcss.com/zepto/1.2.0/zepto.min.js"></script>
	<script src="/js/toggle.js"></script>
</body>
</html>